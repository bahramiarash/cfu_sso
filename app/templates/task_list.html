<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>وظایف پروژه</title>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Bootstrap RTL CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet" integrity="sha384-RWvIoBymqE+ZNyv4WjCh+E+FZd4L9QF8r9jkaG+hEEYX/7dU56Ns6WB6eAebfAy+" crossorigin="anonymous">

    <!-- استایل‌های اختصاصی -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="container py-4 bg-light">
<div class="nav1 mb-3"><a href="/projects">بازگشت به فهرست پروژه‌ها</a></div>

{% extends "base.html" %}
{% block title %}وظایف - {{ project.title }}{% endblock %}

{% block content %}
<h2>وظایف پروژه: {{ project.title }}</h2>

{% if can_create %}
  <a href="{{ url_for('task_create', project_id=project.id) }}" class="btn btn-primary mb-3">+ وظیفه جدید</a>
{% endif %}

<table class="table table-bordered">
  <thead>
    <tr>
      <th>عنوان پروژه</th>
      <th>فاز</th>
      <th>مسئول</th>
      <th>تاریخ سررسید</th>
      <th>عملیات</th>
    </tr>
  </thead>
  <tbody>
    {% for task in tasks %}
      <tr>
        <td>{{ task.title }}</td>
        <td>{{ task.column.title if task.column else '—' }}</td>
        <td>{{ task.assignee.name if task.assignee else '—' }}</td>
        <td>{{ task.due_date or '—' }}</td>
        <td>
          {% if task.id in editable_task_ids %}
            <a href="{{ url_for('task_edit', task_id=task.id) }}" class="btn btn-sm btn-warning">ویرایش</a>
            <a href="{{ url_for('assign_users_to_task', task_id=task.id) }}" class="btn btn-sm btn-info">تخصیص کاربران</a>
          {% else %}
            <span class="text-muted">دسترسی ندارید</span>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<a href="{{ url_for('kanban.project_kanban', project_id=project.id) }}" class="btn btn-secondary">بازگشت به پروژه</a>

{% endblock %}

<!-- Bootstrap Bundle JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-gKZ84Kr84U/9B5qX7mdGOSFaInGkNpe8pEqFQxdJkKr6ZsEr/1OpI3UxF8zINJ9c" crossorigin="anonymous"></script>
</body>
</html>
